<div style="padding-top: 54px;height: 100%">
  <div>
    <div class="ui {{ image.loaded ? '' : 'active' }} dimmer">
      <div class="ui text loader">Loading Next Image</div>
    </div>
  </div>

  <div style="display: flex; height: calc(100vh - 105px);" (keyup.enter)="done()">
    <div class="magnify">
      <div class="maglarge"></div>
      <img class="ui magsmall image" [src]="image.url"/>
      <div id="raphael"></div>
    </div>

    <div style="padding: 0 0 0 0; flex: 1;">
      <div class="ui inverted segment" style="height: 100%; display:flex; flex-direction: column;background: black;">
        <h3 class="ui dividing header" [style.background]="ctxQuality ? '#417d44' : '#1B1C1D'" style="padding: 0.4em 1em 1em 1em; height: 2em; cursor: pointer;" (click)="toogleQuality()">
          <!--<i class="file image outline large icon"></i>-->
          Image Quality
        </h3>
        <div class="ui inverted form" style="flex: 1">
          <div class="field">
            <label>Image Readability</label>
            <div class="ui small buttons">
              <button class="ui grey {{ getStateClass(node(QUALITY).quality, 'GOOD') }} button" (click)="setQuality('GOOD')">Readable</button>
              <button class="ui grey {{ getStateClass(node(QUALITY).quality, 'PARTIAL') }} button" (click)="setQuality('PARTIAL')">Low Confidence</button>
              <button class="ui red {{ getStateClass(node(QUALITY).quality, 'BAD') }} button" (click)="setQuality('BAD')">Unreadable</button>
            </div>
          </div>
          <div class="field">
            <label>Centered in</label>
            <div class="ui small buttons">
              <button class="ui grey {{ getStateClass(node(QUALITY).local, 'MACULA') }} button" (click)="setLocal('MACULA')">Macula</button>
              <button class="ui grey {{ getStateClass(node(QUALITY).local, 'OPTIC_DICS') }} button" (click)="setLocal('OPTIC_DICS')">Optic Disc</button>
              <button class="ui grey {{ getStateClass(node(QUALITY).local, 'OTHER') }} button" (click)="setLocal('OTHER')">Other</button>
            </div>
          </div>
        </div>
        
        <h3 class="ui dividing header" [style.background]="ctxDiagnosis ? '#417d44' : '#1B1C1D'" style="padding: 0.4em 1em 1em 1em; height: 2em; cursor: pointer;" (click)="toogleDiagnosis()">Diagnosis</h3>
        <div class="ui inverted form" style="flex: 1">
          <div class="field">
            <label>Retinopathy</label>
            <div class="ui small buttons">
              <button class="ui grey {{ getStateClass(node(DIAGNOSIS).retinopathy, 'R0') }} button" (click)="setRetinopathy('R0')">R0</button>
              <button class="ui grey {{ getStateClass(node(DIAGNOSIS).retinopathy, 'R1') }} button" (click)="setRetinopathy('R1')">R1</button>
              <button class="ui grey {{ getStateClass(node(DIAGNOSIS).retinopathy, 'R2_M') }} button" (click)="setRetinopathy('R2_M')">R2-M</button>
              <button class="ui grey {{ getStateClass(node(DIAGNOSIS).retinopathy, 'R2_S') }} button" (click)="setRetinopathy('R2_S')">R2-S</button>
              <button class="ui grey {{ getStateClass(node(DIAGNOSIS).retinopathy, 'R3') }} button" (click)="setRetinopathy('R3')">R3</button>
            </div>
          </div>
          <div class="field">
            <label>Maculopathy</label>
            <div class="ui small buttons">
              <button class="ui grey {{ getStateClass(node(DIAGNOSIS).maculopathy, 'M0') }} button" (click)="setMaculopathy('M0')">M0</button>
              <button class="ui grey {{ getStateClass(node(DIAGNOSIS).maculopathy, 'M1') }} button" (click)="setMaculopathy('M1')">M1</button>
            </div>
          </div>
          <div class="field">
            <label>Photocoagulation</label>
            <div class="ui small buttons">
              <button class="ui grey {{ getStateClass(node(DIAGNOSIS).photocoagulation, 'P0') }} button" (click)="setPhotocoagulation('P0')">P0</button>
              <button class="ui grey {{ getStateClass(node(DIAGNOSIS).photocoagulation, 'P1') }} button" (click)="setPhotocoagulation('P1')">P1</button>
              <button class="ui grey {{ getStateClass(node(DIAGNOSIS).photocoagulation, 'P2') }} button" (click)="setPhotocoagulation('P2')">P2</button>
            </div>
          </div>
        </div>

        <h3 class="ui dividing header" [style.background]="ctxLesions ? '#417d44' : '#1B1C1D'" style="padding: 0.4em 1em 1em 1em; height: 2em; cursor: pointer;" (click)="toogleLesions()">Lesions</h3>
        <div class="ui inverted form" style="flex: 1">
          <div class="field">
            <!--<label>Tools</label>-->
            <div class="ui small buttons">
              <button class="ui blue {{ tool == 'MA' ? '' : 'basic' }} button"  (click)="tool = 'MA'">MA</button>
              <button class="ui teal {{ tool == 'HEM' ? '' : 'basic' }} button" (click)="tool = 'HEM'">HEM</button>
              <button class="ui green {{ tool == 'HE' ? '' : 'basic' }} button"  (click)="tool = 'HE'">HE</button>
              <button class="ui olive {{ tool == 'SE' ? '' : 'basic' }} button"  (click)="tool = 'SE'">SE</button>
              <button class="ui grey {{ tool == 'NV' ? '' : 'basic' }} button"  (click)="tool = 'NV'">NV</button>
            </div>
          </div>
          <div class="field">
            <!--<label>Removers</label>-->
            <div class="ui small buttons">
              <button class="ui icon grey basic button" (click)="eraseLast()">
                <i class="backward large icon"></i>
              </button>
              <button class="ui icon grey basic button" (click)="eraseAll()">
                <i class="trash large icon"></i>
              </button>
              <button class="ui icon grey {{ tool == 'ERASER' ? '' : 'basic' }} button" (click)="tool = 'ERASER'">
                <i class="erase large icon"></i>
              </button>
              <button class="ui icon grey {{ tool == 'MAG' ? '' : 'basic' }} button" (click)="tool = 'MAG'">
                <i class="zoom large icon"></i>
              </button>
            </div>
          </div>
        </div>

        <div class="ui {{ isReadyToDone() ? '' : 'basic disabled' }} small button" style="margin-top: 2em;" (click)="done()">
          <div class="visible content">Save</div>
        </div>
      </div>
    </div>
  </div>
  
  <!--Progress and Load-->
  <div class="column" style="margin: auto; padding: 10px 5px 0px 10px; display:flex;">
    
    <div class="ui progress" style="flex: auto;">
      <div class="bar" style="height:100%; min-width:6em;"><div class="progress"></div></div>
    </div>

    <div style="display: flex; align-items: center; margin-left: 0.3em;">
      <i class="fast backward large link icon" (click)="setPosition(1)"></i>
      <i class="step backward large link icon" (click)="setPosition(progress)"></i>
      <div class="ui mini input" style="width: 6em">
        <input #pos type="number" [min]="1" [max]="dsLast + 1" style="text-align: right;" (keyup.enter)="setPosition(pos.value)" [value]="progress + 1">
      </div>
      <i class="step forward large link icon" (click)="setPosition(progress + 2)"></i>
      <i class="fast forward large link icon" (click)="setPosition()"></i>
    </div>
  </div>
</div>